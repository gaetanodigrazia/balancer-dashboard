<h2>Scorte attuali</h2>

<div *ngIf="loading">Caricamento...</div>
<div *ngIf="error" style="color: red;">⚠️ {{ error }}</div>

<!-- Form inserimento prodotto -->
<form (submit)="aggiungiProdotto(); $event.preventDefault()" style="margin-bottom:20px;">
  <div>
    <label for="nome">Nome Prodotto:</label><br />
    <input
      id="nome"
      type="text"
      placeholder="Es. Latte intero"
      [(ngModel)]="nuovoProdotto.nome"
      name="nome"
      required
      autocomplete="off"
    />
  </div>

  <div>
    <label for="quantita">Quantità:</label><br />
    <input
      id="quantita"
      type="number"
      placeholder="Es. 3"
      [(ngModel)]="nuovoProdotto.quantita"
      name="quantita"
      required
      min="1"
    />
  </div>

  <div>
    <label for="prezzo_unitario">Prezzo unitario (€):</label><br />
    <input
      id="prezzo_unitario"
      type="number"
      placeholder="Es. 1.50"
      [(ngModel)]="nuovoProdotto.prezzo_unitario"
      name="prezzo_unitario"
      required
      step="0.01"
      min="0"
    />
  </div>

  <button type="submit" style="margin-top:10px;">Aggiungi Prodotto</button>
</form>

<table *ngIf="!loading && !error && scorte.length > 0" border="1" cellpadding="6">
  <thead>
    <tr>
      <th>Nome</th>
      <th>Quantità Totale</th>
      <th>Prezzo Unitario Medio (€)</th>
      <th>ID Scontrini Associati</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let prodotto of scorte">
      <td>{{ prodotto.nome }}</td>
      <td>{{ prodotto.quantita }}</td>
      <td>{{ prodotto.prezzo_unitario | number:'1.2-2' }}</td>
      <td>{{ prodotto.scontrino_ids.join(', ') }}</td>
    </tr>
  </tbody>
</table>

<div *ngIf="!loading && !error && scorte.length === 0">
  Nessun prodotto presente nelle scorte.
</div>
